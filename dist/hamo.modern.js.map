{"version":3,"file":"hamo.modern.js","sources":["../src/hooks/use-click-outside-event.js","../src/hooks/use-debug.js","../src/misc/util.js","../src/hooks/use-isomorphic-layout-effect.js","../src/hooks/use-document-ready-state.js","../src/hooks/use-event-bus.js","../src/hooks/use-frame.js","../src/hooks/use-id.js","../src/hooks/use-interval.js","../src/hooks/use-is-touch-device.js","../src/hooks/use-is-visible.js","../src/hooks/use-media-query.js","../src/hooks/use-rect.js","../src/hooks/use-slots.js"],"sourcesContent":["import { useCallback, useEffect } from 'react'\r\n\r\nexport function useOutsideClickEvent(ref, callback) {\r\n  const handleClickOutside = useCallback(\r\n    (event) => {\r\n      if (ref.current && !ref.current.contains(event.target)) {\r\n        callback()\r\n      }\r\n    },\r\n    [ref, callback]\r\n  )\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('mousedown', handleClickOutside)\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside)\r\n    }\r\n  }, [handleClickOutside])\r\n}\r\n\r\nexport default useOutsideClickEvent\r\n","import { useMemo } from 'react'\r\n\r\nexport const useDebug = () => {\r\n  const debug = useMemo(\r\n    () =>\r\n      typeof window !== 'undefined'\r\n        ? window.location.href.includes('#debug') ||\r\n          process.env.NODE_ENV === 'development'\r\n        : false,\r\n    []\r\n  )\r\n  return debug\r\n}\r\n\r\nexport default useDebug\r\n","export const isBrowser = typeof window !== 'undefined'\r\n\r\nexport const noop = () => {}\r\n\r\nexport const on = (obj, ...args) => {\r\n  if (obj && obj.addEventListener) {\r\n    obj.addEventListener(...args)\r\n  }\r\n}\r\n\r\nexport const off = (obj, ...args) => {\r\n  if (obj && obj.removeEventListener) {\r\n    obj.removeEventListener(...args)\r\n  }\r\n}\r\n","import { useEffect, useLayoutEffect as vanillaUseLayoutEffect } from 'react'\r\nimport { isBrowser } from '../misc/util'\r\n\r\nexport const useLayoutEffect = isBrowser ? vanillaUseLayoutEffect : useEffect\r\n\r\nexport default useLayoutEffect\r\n","import { useState } from 'react'\r\nimport { useLayoutEffect } from './use-isomorphic-layout-effect'\r\n\r\nfunction _useDocumentReadyState() {\r\n  const [readyState, setReadyState] = useState(document.readyState)\r\n\r\n  useLayoutEffect(() => {\r\n    setReadyState(document.readyState)\r\n\r\n    function onStateChange() {\r\n      setReadyState(document.readyState)\r\n    }\r\n\r\n    document.addEventListener('readystatechange', onStateChange, false)\r\n\r\n    return () =>\r\n      document.removeEventListener('readystatechange', onStateChange, false)\r\n  }, [])\r\n\r\n  return readyState\r\n}\r\n\r\nexport const useDocumentReadyState =\r\n  typeof window !== 'undefined' ? _useDocumentReadyState : () => undefined\r\n\r\nexport default useDocumentReadyState\r\n","import { useEffect } from 'react'\r\n\r\nlet subscribers = []\r\n\r\nconst subscribe = (filter, callbackFn) => {\r\n  if (filter === undefined || filter === null) return undefined\r\n  if (callbackFn === undefined || callbackFn === null) return undefined\r\n\r\n  subscribers = [...subscribers, [filter, callbackFn]]\r\n\r\n  return () => {\r\n    subscribers = subscribers.filter(\r\n      (subscriber) => subscriber[1] !== callbackFn\r\n    )\r\n  }\r\n}\r\n\r\nexport const dispatch = (event) => {\r\n  let { type } = event\r\n  if (typeof event === 'string') type = event\r\n\r\n  const args = []\r\n  if (typeof event === 'string') args.push({ type })\r\n  else args.push(event)\r\n\r\n  subscribers.forEach(([filter, callbackFn]) => {\r\n    if (typeof filter === 'string' && filter !== type) return\r\n    if (typeof filter === 'function' && !filter(...args)) return\r\n    callbackFn(...args)\r\n  })\r\n}\r\n\r\nexport const useEventBus = (type, callback, deps = []) => {\r\n  /* eslint-disable */\r\n  useEffect(() => subscribe(type, callback), [...deps, callback, type])\r\n  /* eslint-enable */\r\n\r\n  return dispatch\r\n}\r\n\r\nexport default useEventBus\r\n","import { raf } from '@studio-freight/tempus'\r\nimport { useEffect } from 'react'\r\n\r\nexport function useFrame(callback, priority = 0) {\r\n  useEffect(() => {\r\n    if (callback) {\r\n      const id = raf.add(callback, priority)\r\n\r\n      return () => {\r\n        raf.remove(id)\r\n      }\r\n    }\r\n  }, [callback, priority])\r\n}\r\n\r\nexport default useFrame\r\n","import { nanoid } from 'nanoid'\r\nimport { useMemo } from 'react'\r\n\r\nexport function useId() {\r\n  const id = useMemo(() => nanoid(), [])\r\n\r\n  return id\r\n}\r\n\r\nexport default useId","import { useEffect, useRef } from 'react'\r\n\r\nexport const useInterval = (callback, delay) => {\r\n  const savedCallback = useRef()\r\n\r\n  useEffect(() => {\r\n    savedCallback.current = callback\r\n  })\r\n\r\n  useEffect(() => {\r\n    function tick() {\r\n      savedCallback.current()\r\n    }\r\n    if (delay !== null) {\r\n      const id = setInterval(tick, delay)\r\n      return () => clearInterval(id)\r\n    }\r\n  }, [delay])\r\n}\r\n\r\nexport default useInterval\r\n","import { useCallback, useState } from 'react'\r\nimport { useLayoutEffect } from './use-isomorphic-layout-effect'\r\n\r\nexport const useIsTouchDevice = () => {\r\n  const [isTouchDevice, setIsTouchDevice] = useState(undefined)\r\n\r\n  const onResize = useCallback(() => {\r\n    setIsTouchDevice(\r\n      'ontouchstart' in window ||\r\n        navigator.maxTouchPoints > 0 ||\r\n        navigator.msMaxTouchPoints > 0\r\n    )\r\n  }, [])\r\n\r\n  useLayoutEffect(() => {\r\n    onResize()\r\n    window.addEventListener('resize', onResize, false)\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', onResize, false)\r\n    }\r\n  }, [])\r\n\r\n  return isTouchDevice\r\n}\r\n\r\nexport default useIsTouchDevice\r\n","import { useCallback, useEffect, useRef, useState } from 'react'\r\n\r\nexport const useIsVisible = ({\r\n  root = null,\r\n  rootMargin = '0px',\r\n  threshold = 1.0,\r\n} = {}) => {\r\n  const ref = useRef()\r\n  const [inView, setInView] = useState(false)\r\n\r\n  const setRef = (node) => {\r\n    if (!ref.current) {\r\n      ref.current = node\r\n    }\r\n  }\r\n\r\n  const callbackFunction = useCallback((entries) => {\r\n    const [entry] = entries\r\n    setInView(entry.isIntersecting)\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const observer = new IntersectionObserver(callbackFunction, {\r\n      root,\r\n      rootMargin,\r\n      threshold,\r\n    })\r\n    if (ref.current) observer.observe(ref.current)\r\n    return () => {\r\n      observer.disconnect()\r\n    }\r\n  }, [callbackFunction])\r\n\r\n  return { setRef, inView }\r\n}\r\n\r\nexport default useIsVisible\r\n","import { useCallback, useState } from 'react'\r\nimport { useLayoutEffect } from './use-isomorphic-layout-effect'\r\n\r\nexport const useMediaQuery = (queryString) => {\r\n  const [isMatch, setIsMatch] = useState(undefined)\r\n\r\n  const mqChange = useCallback((mq) => {\r\n    setIsMatch(mq.matches)\r\n  }, [])\r\n\r\n  useLayoutEffect(() => {\r\n    const mq = window.matchMedia(queryString)\r\n    mqChange(mq)\r\n\r\n    mq.addEventListener('change', mqChange)\r\n\r\n    return () => {\r\n      mq.removeEventListener('change', mqChange)\r\n    }\r\n  })\r\n\r\n  return isMatch\r\n}\r\n\r\nexport default useMediaQuery\r\n","import { useLayoutEffect } from '@studio-freight/hamo'\r\nimport { useRef, useState } from 'react'\r\nimport { throttle } from 'throttle-debounce'\r\n\r\nexport function offsetTop(element, accumulator = 0) {\r\n  const top = accumulator + element.offsetTop\r\n  if (element.offsetParent) {\r\n    return offsetTop(element.offsetParent, top)\r\n  }\r\n  return top\r\n}\r\n\r\nexport function offsetLeft(element, accumulator = 0) {\r\n  const left = accumulator + element.offsetLeft\r\n  if (element.offsetParent) {\r\n    return offsetLeft(element.offsetParent, left)\r\n  }\r\n  return left\r\n}\r\n\r\nexport default function useRect({ debounce = 1000 } = {}) {\r\n  const element = useRef()\r\n\r\n  const [rect, setRect] = useState({\r\n    top: undefined,\r\n    left: undefined,\r\n    width: undefined,\r\n    height: undefined,\r\n  })\r\n\r\n  const resize = () => {\r\n    if (element.current) {\r\n      setRect((prev) => ({\r\n        ...prev,\r\n        top: offsetTop(element.current),\r\n        left: offsetLeft(element.current),\r\n      }))\r\n    }\r\n  }\r\n\r\n  // resize if body height changes\r\n  useLayoutEffect(() => {\r\n    const callback = throttle(debounce, resize)\r\n    const resizeObserver = new ResizeObserver(callback)\r\n    resizeObserver.observe(document.body)\r\n\r\n    return () => {\r\n      resizeObserver.disconnect()\r\n      callback.cancel({ upcomingOnly: true })\r\n    }\r\n  }, [debounce])\r\n\r\n  const onResizeObserver = ([entry]) => {\r\n    const { width, height } = entry.contentRect\r\n\r\n    setRect((prev) => ({\r\n      ...prev,\r\n      width,\r\n      height,\r\n    }))\r\n  }\r\n\r\n  const resizeObserver = useRef()\r\n\r\n  const setRef = (node) => {\r\n    if (!node || node === element.current) return\r\n\r\n    resizeObserver.current?.disconnect()\r\n    resizeObserver.current = new ResizeObserver(onResizeObserver)\r\n\r\n    resizeObserver.current.observe(node)\r\n\r\n    element.current = node\r\n  }\r\n\r\n  const getRect = (x = 0, y = 0) => {\r\n    return rect\r\n  }\r\n\r\n  return [setRef, rect, getRect]\r\n}\r\n","// https://medium.com/swlh/bring-vue-named-slots-to-react-87684188f18e\r\n\r\nimport { useMemo } from 'react'\r\n\r\nexport const useSlots = (types = [], children = []) => {\r\n  const _children = useMemo(() => children && [children].flat(), [children])\r\n  const _types = useMemo(() => types && [types].flat(), [types])\r\n  const slots = useMemo(\r\n    () =>\r\n      _children &&\r\n      _types &&\r\n      _types.map(\r\n        // @ts-ignore\r\n        (type) => _children.find((el) => el.type === type)?.props.children\r\n      ),\r\n    [_children, _types]\r\n  )\r\n\r\n  return types[0] ? slots : slots[0]\r\n}\r\n\r\nexport default useSlots\r\n"],"names":["ref","callback","useCallback","event","current","contains","target","useEffect","document","addEventListener","handleClickOutside","removeEventListener","useMemo","window","location","href","includes","process","env","NODE_ENV","vanillaUseLayoutEffect","readyState","setReadyState","useState","useLayoutEffect","onStateChange","type","args","push","subscribers","forEach","filter","callbackFn","deps","subscriber","subscribe","priority","raf","add","remove","id","nanoid","delay","useRef","savedCallback","setInterval","clearInterval","isTouchDevice","setIsTouchDevice","undefined","navigator","maxTouchPoints","msMaxTouchPoints","onResize","root","rootMargin","threshold","inView","setInView","entries","entry","isIntersecting","callbackFunction","observer","observe","disconnect","setRef","node","queryString","isMatch","setIsMatch","mq","matches","matchMedia","mqChange","element","accumulator","offsetTop","offsetParent","top","offsetLeft","left","debounce","rect","setRect","width","height","prev","throttle","resize","resizeObserver","body","cancel","upcomingOnly","contentRect","onResizeObserver","x","y","types","children","flat","_children","_types","map","find","el","_children$find","props","slots"],"mappings":"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"}