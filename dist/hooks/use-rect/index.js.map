{"version":3,"file":"index.js","sources":["../../../src/hooks/use-rect/index.js"],"sourcesContent":["import { debounce as _debounce } from 'debounce'\nimport { useLayoutEffect, useRef, useState } from 'react'\nimport { useMeasure, useWindowSize } from 'react-use'\n\nexport function offsetTop(element, accumulator = 0) {\n  const top = accumulator + element.offsetTop\n  if (element.offsetParent) {\n    return offsetTop(element.offsetParent, top)\n  }\n  return top\n}\n\nexport function offsetLeft(element, accumulator = 0) {\n  const left = accumulator + element.offsetLeft\n  if (element.offsetParent) {\n    return offsetLeft(element.offsetParent, left)\n  }\n  return left\n}\n\nfunction _useRect(debounce = 1000) {\n  const ref = useRef()\n  const [refMeasure, { width, height }] = useMeasure()\n  const { width: windowWidth, height: windowHeight } = useWindowSize()\n  const [left, setLeft] = useState()\n  const [top, setTop] = useState()\n\n  // resize if body height changes\n  useLayoutEffect(() => {\n    const callback = _debounce(resize, debounce)\n    const resizeObserver = new ResizeObserver(callback)\n    resizeObserver.observe(document.body)\n\n    return () => {\n      resizeObserver.disconnect()\n      callback.flush()\n    }\n  }, [debounce])\n\n  const resize = () => {\n    if (ref.current) {\n      setTop(offsetTop(ref.current))\n      setLeft(offsetLeft(ref.current))\n    }\n  }\n\n  const compute = (scrollY = 0) => {\n    const rect = {\n      top: top - scrollY,\n      left: left,\n      height: height,\n      width: width,\n      bottom: windowHeight - (top - scrollY + height),\n      right: windowWidth - (left + width),\n    }\n    const inView = rect.top + rect.height > 0 && rect.bottom + rect.height > 0\n\n    return { ...rect, inView }\n  }\n\n  const setRef = (node) => {\n    ref.current = node\n    refMeasure(node)\n    resize()\n  }\n\n  return [setRef, compute]\n}\n\nexport const useRect =\n  typeof window !== 'undefined' ? _useRect : () => [() => {}, undefined]\n"],"names":["offsetTop","element","accumulator","top","offsetParent","offsetLeft","left","_useRect","debounce","ref","useRef","refMeasure","width","height","useMeasure","windowWidth","windowHeight","useWindowSize","setLeft","useState","setTop","resize","useLayoutEffect","callback","_debounce","resizeObserver","ResizeObserver","observe","document","body","disconnect","flush","current","node","scrollY","rect","bottom","right","inView","useRect","window","undefined"],"mappings":"6IAIO,SAASA,UAAUC,EAASC,EAAc,GACzCC,GAAoBF,EAAQD,UAClC,OAAIC,EAAQG,aACHJ,UAAUC,EAAQG,aAAcD,GAElCA,EAGF,SAASE,WAAWJ,EAASC,EAAc,GAC1CI,GAAqBL,EAAQI,WACnC,OAAIJ,EAAQG,aACHC,WAAWJ,EAAQG,aAAcE,GAEnCA,EAGT,SAASC,SAASC,EAAW,KAC3B,MAAMC,EAAMC,eACN,CAACC,EAAY,CAAEC,MAAAA,EAAOC,OAAAA,IAAYC,sBAClC,CAAEF,MAAOG,EAAaF,OAAQG,GAAiBC,yBAC/C,CAACX,EAAMY,GAAWC,iBAClB,CAAChB,EAAKiB,GAAUD,iBAchBE,GAXNC,sBAAgB,KACd,MAAMC,EAAWC,kBAAUH,EAAQb,GAC7BiB,EAAiB,IAAIC,eAAeH,GAG1C,OAFAE,EAAeE,QAAQC,SAASC,MAEzB,KACLJ,EAAeK,aACfP,EAASQ,UAEV,CAACvB,IAEW,KACTC,EAAIuB,UACNZ,EAAOpB,UAAUS,EAAIuB,UACrBd,EAAQb,WAAWI,EAAIuB,aAwB3B,MAAO,CANQ,IACbvB,EAAIuB,QAAUC,EACdtB,EAAWsB,GACXZ,KAjBc,CAACa,EAAU,KACzB,IAAMC,EAAO,CACXhC,IAAKA,EAAM+B,EACX5B,KAAMA,EACNO,OAAQA,EACRD,MAAOA,EACPwB,OAAQpB,GAAgBb,EAAM+B,EAAUrB,GACxCwB,MAAOtB,GAAeT,EAAOM,IAEzB0B,EAAkC,EAAzBH,EAAKhC,IAAMgC,EAAKtB,QAA0C,EAA5BsB,EAAKC,OAASD,EAAKtB,OAEhE,MAAO,IAAKsB,EAAMG,OAAAA,KAYV,MAACC,QACO,oBAAXC,OAAyBjC,SAAW,IAAM,CAAC,YAAUkC"}