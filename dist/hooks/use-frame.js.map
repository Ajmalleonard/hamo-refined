{"version":3,"file":"use-frame.js","sources":["../../src/hooks/use-frame.js"],"sourcesContent":["import { raf } from '@react-spring/rafz'\nimport { useLayoutEffect, useMemo } from 'react'\nimport { v4 as uuidv4 } from 'uuid'\n\n// https://github.com/pmndrs/react-spring/tree/master/packages/rafz#readme\n\nconst callbacks = {}\n\nraf.onFrame(() => {\n  Object.entries(callbacks)\n    .sort((a, b) => a[1].priority - b[1].priority)\n    .forEach(([, { callback }]) => {\n      callback(raf.now())\n    })\n  return true\n})\n\nexport function useFrame(callback, priority = 0, deps = []) {\n  const id = useMemo(() => uuidv4(), [])\n\n  useLayoutEffect(() => {\n    if (callback) {\n      callbacks[id] = { callback, priority }\n\n      return () => {\n        delete callbacks[id]\n      }\n    }\n  }, [callback, id, priority, ...deps])\n}\n"],"names":["callbacks","useFrame","callback","priority","deps","id","useMemo","uuidv4","useLayoutEffect","raf","onFrame","Object","entries","sort","a","b","forEach","now"],"mappings":"0IAMA,MAAMA,UAAY,GAWX,SAASC,SAASC,EAAUC,EAAW,EAAGC,EAAO,IACtD,MAAMC,EAAKC,cAAQ,IAAMC,UAAU,IAEnCC,sBAAgB,KACd,GAAIN,EAGF,OAFAF,UAAUK,GAAM,CAAEH,SAAAA,EAAUC,SAAAA,GAErB,YACEH,UAAUK,KAGpB,CAACH,EAAUG,EAAIF,KAAaC,IApBjCK,SAAIC,QAAQ,KACVC,OAAOC,QAAQZ,WACZa,KAAK,CAACC,EAAGC,IAAMD,EAAE,GAAGX,SAAWY,EAAE,GAAGZ,UACpCa,QAAQ,CAAA,EAAI,CAAEd,SAAAA,OACbA,EAASO,SAAIQ,UAEV"}