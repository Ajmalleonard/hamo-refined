{"version":3,"file":"use-frame.js","sources":["../../src/hooks/use-frame.js"],"sourcesContent":["import { raf } from '@react-spring/rafz'\r\nimport { useLayoutEffect, useMemo } from 'react'\r\nimport { v4 as uuidv4 } from 'uuid'\r\n\r\n// https://github.com/pmndrs/react-spring/tree/master/packages/rafz#readme\r\n\r\nconst callbacks = {}\r\n\r\nraf.onFrame(() => {\r\n  Object.entries(callbacks)\r\n    .sort((a, b) => a[1].priority - b[1].priority)\r\n    .forEach(([, { callback }]) => {\r\n      callback(raf.now())\r\n    })\r\n  return true\r\n})\r\n\r\nexport function useFrame(callback, priority = 0, deps = []) {\r\n  const id = useMemo(() => uuidv4(), [])\r\n\r\n  useLayoutEffect(() => {\r\n    if (callback) {\r\n      callbacks[id] = { callback, priority }\r\n\r\n      return () => {\r\n        delete callbacks[id]\r\n      }\r\n    }\r\n  }, [callback, id, priority, ...deps])\r\n}\r\n"],"names":["callbacks","useFrame","callback","priority","deps","id","useMemo","uuidv4","useLayoutEffect","raf","onFrame","Object","entries","sort","a","b","forEach","now"],"mappings":"0IAMA,MAAMA,UAAY,GAWX,SAASC,SAASC,EAAUC,EAAW,EAAGC,EAAO,IACtD,MAAMC,EAAKC,cAAQ,IAAMC,UAAU,IAEnCC,sBAAgB,KACd,GAAIN,EAGF,OAFAF,UAAUK,GAAM,CAAEH,SAAAA,EAAUC,SAAAA,GAErB,YACEH,UAAUK,KAGpB,CAACH,EAAUG,EAAIF,KAAaC,IApBjCK,SAAIC,QAAQ,KACVC,OAAOC,QAAQZ,WACZa,KAAK,CAACC,EAAGC,IAAMD,EAAE,GAAGX,SAAWY,EAAE,GAAGZ,UACpCa,QAAQ,CAAA,EAAI,CAAEd,SAAAA,OACbA,EAASO,SAAIQ,UAEV"}