import{useCallback as e,useEffect as t,useMemo as n,useLayoutEffect as r,useState as o,useRef as c}from"react";import{raf as s}from"@studio-freight/tempus";import{nanoid as u}from"nanoid";import{throttle as i}from"throttle-debounce";function a(n,r){const o=e(e=>{n.current&&!n.current.contains(e.target)&&r()},[n,r]);t(()=>(document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}),[o])}const d="undefined"!=typeof window;var f=d?()=>n(()=>(window.location.href.includes("#debug")||"development"===process.env.NODE_ENV)&&!window.location.href.includes("#production"),[]):()=>{};const v="undefined"!=typeof window?r:t,l="undefined"!=typeof window?function(){const[e,t]=o(document.readyState);return v(()=>{function e(){t(document.readyState)}return t(document.readyState),document.addEventListener("readystatechange",e,!1),()=>document.removeEventListener("readystatechange",e,!1)},[]),e}:()=>{};let p=[];const m=e=>{let{type:t}=e;"string"==typeof e&&(t=e);const n=[];n.push("string"==typeof e?{type:t}:e),p.forEach(([e,r])=>{"string"==typeof e&&e!==t||("function"!=typeof e||e(...n))&&r(...n)})},h=(e,n,r=[])=>(t(()=>((e,t)=>{if(null!=e&&null!=t)return p=[...p,[e,t]],()=>{p=p.filter(e=>e[1]!==t)}})(e,n),[...r,n,e]),m);function w(e,n=0){t(()=>{if(e){const t=s.add(e,n);return()=>{s.remove(t)}}},[e,n])}function y(){return n(()=>u(),[])}const g=(e,n)=>{const r=c();t(()=>{r.current=e}),t(()=>{if(null!==n){const e=setInterval(function(){r.current()},n);return()=>clearInterval(e)}},[n])};var b=d?()=>{const n=e(()=>"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,[]),[r,c]=o(n()),s=e(()=>{c(n())},[n]);return t(()=>(s(),window.addEventListener("resize",s,{passive:!0}),()=>{window.removeEventListener("resize",s,{passive:!0})}),[s]),r}:()=>{};const E=({root:n=null,rootMargin:r="0px",threshold:s=1,once:u=!1}={})=>{const i=c(),a=c(),[d,f]=o(!1),v=e(e=>{const[t]=e;f(t.isIntersecting)},[]);return t(()=>(i.current=new IntersectionObserver(v,{root:n,rootMargin:r,threshold:s}),a.current&&i.current.observe(a.current),()=>{i.current.disconnect()}),[v]),t(()=>{u&&d&&i.current.disconnect()},[d]),{setRef:e=>{a.current||(a.current=e)},inView:d}};var L=d?r=>{const c=n(()=>window.matchMedia(r),[r]),[s,u]=o(c.matches),i=e(({matches:e})=>{u(e)},[]);return t(()=>(i(c),c.addEventListener("change",i,{passive:!0}),()=>{c.removeEventListener("change",i,{passive:!0})}),[c,i]),s}:()=>{};function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},O.apply(this,arguments)}function P(e,t=0){const n=t+e.offsetTop;return e.offsetParent?P(e.offsetParent,n):n}function z(e,t=0){const n=t+e.offsetLeft;return e.offsetParent?z(e.offsetParent,n):n}function I({lazy:n=!1,debounce:r=1e3}={}){const s=c(),u=c(),[a,d]=o({}),f=c(a),v=e(()=>{if(s.current){const e=P(s.current),t=z(s.current);f.current=O({},f.current,{top:e,left:t}),n||d(f.current)}},[n]);t(()=>{const e=i(r,v),t=new ResizeObserver(e);return t.observe(document.body),()=>{t.disconnect(),e.cancel({upcomingOnly:!0})}},[r,v]);const l=e(([e])=>{const{width:t,height:r}=e.contentRect;f.current=O({},f.current,{width:t,height:r}),n||d(f.current)},[n]),p=e(()=>f.current,[]);return t(()=>()=>{var e;"development"!==process.env.NODE_ENV&&(null==(e=u.current)||e.disconnect())},[]),[e(e=>{var t;e&&e!==s.current&&(null==(t=u.current)||t.disconnect(),u.current=new ResizeObserver(l),u.current.observe(e),s.current=e)},[v]),n?p:a]}const M=(e=[],t=[])=>{const r=n(()=>t&&[t].flat(),[t]),o=n(()=>e&&[e].flat(),[e]),c=n(()=>r&&o&&o.map(e=>{var t;return null==(t=r.find(t=>t.type===e))?void 0:t.props.children}),[r,o]);return e[0]?c:c[0]};export{m as dispatch,f as useDebug,l as useDocumentReadyState,h as useEventBus,w as useFrame,y as useId,g as useInterval,b as useIsTouchDevice,E as useIsVisible,v as useLayoutEffect,L as useMediaQuery,a as useOutsideClickEvent,I as useRect,M as useSlots};
//# sourceMappingURL=index.modern.mjs.map
